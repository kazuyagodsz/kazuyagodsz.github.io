!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],t):t((e=e||self).firebase)}(this,(function(e){"use strict";try{(function(){e=e&&e.hasOwnProperty("default")?e.default:e;var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,n)};function n(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var r=function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function i(e,t,n,r){return new(n=n||Promise)((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(s,a)}c((r=r.apply(e,t||[])).next())}))}function o(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=0<(i=s.trys).length&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function s(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function a(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(s(arguments[t]));return e}var c,u=(n(f,c=Error),f);function f(e,t){var n=c.call(this,t)||this;return n.code=e,n.name="FirebaseError",Object.setPrototypeOf(n,f.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,l.prototype.create),n}var l=(p.prototype.create=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=t[0]||{},i=this.service+"/"+e,o=this.errors[e],s=o?function(e,t){return e.replace(d,(function(e,n){var r=t[n];return null!=r?r.toString():"<"+n+"?>"}))}(o,r):"Error",a=this.serviceName+": "+s+" ("+i+").",c=new u(i,a),f=0,l=Object.keys(r);f<l.length;f++){var p=l[f];"_"!==p.slice(-1)&&(p in c&&console.warn('Overwriting FirebaseError base field "'+p+'" can cause unexpected behavior.'),c[p]=r[p])}return c},p);function p(e,t,n){this.service=e,this.serviceName=t,this.errors=n}var d=/\{\$([^}]+)}/g;function h(e,t){var n=new v(e,t);return n.subscribe.bind(n)}var v=(b.prototype.next=function(e){this.forEachObserver((function(t){t.next(e)}))},b.prototype.error=function(e){this.forEachObserver((function(t){t.error(e)})),this.close(e)},b.prototype.complete=function(){this.forEachObserver((function(e){e.complete()})),this.close()},b.prototype.subscribe=function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in e&&"function"==typeof e[i])return!0}return!1}(e)?e:{next:e,error:t,complete:n}).next&&(r.next=g),void 0===r.error&&(r.error=g),void 0===r.complete&&(r.complete=g);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}})),this.observers.push(r),o},b.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},b.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},b.prototype.sendOne=function(e,t){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))},b.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((function(){t.observers=void 0,t.onNoObservers=void 0})))},b);function b(e,t){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((function(){e(n)})).catch((function(e){n.error(e)}))}function g(){}var y=(w.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},w.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},w.prototype.setServiceProps=function(e){return this.serviceProps=e,this},w);function w(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}function m(e){return new Promise((function(t,n){e.onsuccess=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function k(e,t,n){var r,i=new Promise((function(i,o){m(r=e[t].apply(e,n)).then(i,o)}));return i.request=r,i}function S(e,t,n){n.forEach((function(n){Object.defineProperty(e.prototype,n,{get:function(){return this[t][n]},set:function(e){this[t][n]=e}})}))}function T(e,t,n,r){r.forEach((function(r){r in n.prototype&&(e.prototype[r]=function(){return k(this[t],r,arguments)})}))}function _(e,t,n,r){r.forEach((function(r){r in n.prototype&&(e.prototype[r]=function(){return this[t][r].apply(this[t],arguments)})}))}function P(e,t,n,r){r.forEach((function(r){r in n.prototype&&(e.prototype[r]=function(){return function(e,t,n){var r=k(e,t,n);return r.then((function(e){if(e)return new D(e,r.request)}))}(this[t],r,arguments)})}))}function I(e){this._index=e}function D(e,t){this._cursor=e,this._request=t}function C(e){this._store=e}function M(e){this._tx=e,this.complete=new Promise((function(t,n){e.oncomplete=function(){t()},e.onerror=function(){n(e.error)},e.onabort=function(){n(e.error)}}))}function N(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new M(n)}function x(e){this._db=e}S(I,"_index",["name","keyPath","multiEntry","unique"]),T(I,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),P(I,"_index",IDBIndex,["openCursor","openKeyCursor"]),S(D,"_cursor",["direction","key","primaryKey","value"]),T(D,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach((function(e){e in IDBCursor.prototype&&(D.prototype[e]=function(){var t=this,n=arguments;return Promise.resolve().then((function(){return t._cursor[e].apply(t._cursor,n),m(t._request).then((function(e){if(e)return new D(e,t._request)}))}))})})),C.prototype.createIndex=function(){return new I(this._store.createIndex.apply(this._store,arguments))},C.prototype.index=function(){return new I(this._store.index.apply(this._store,arguments))},S(C,"_store",["name","keyPath","indexNames","autoIncrement"]),T(C,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),P(C,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),_(C,"_store",IDBObjectStore,["deleteIndex"]),M.prototype.objectStore=function(){return new C(this._tx.objectStore.apply(this._tx,arguments))},S(M,"_tx",["objectStoreNames","mode"]),_(M,"_tx",IDBTransaction,["abort"]),N.prototype.createObjectStore=function(){return new C(this._db.createObjectStore.apply(this._db,arguments))},S(N,"_db",["name","version","objectStoreNames"]),_(N,"_db",IDBDatabase,["deleteObjectStore","close"]),x.prototype.transaction=function(){return new M(this._db.transaction.apply(this._db,arguments))},S(x,"_db",["name","version","objectStoreNames"]),_(x,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach((function(e){[C,I].forEach((function(t){e in t.prototype&&(t.prototype[e.replace("open","iterate")]=function(){var t=function(e){return Array.prototype.slice.call(e)}(arguments),n=t[t.length-1],r=this._store||this._index,i=r[e].apply(r,t.slice(0,-1));i.onsuccess=function(){n(i.result)}})}))})),[I,C].forEach((function(e){e.prototype.getAll||(e.prototype.getAll=function(e,t){var n=this,r=[];return new Promise((function(i){n.iterateCursor(e,(function(e){e?(r.push(e.value),void 0===t||r.length!=t?e.continue():i(r)):i(r)}))}))})}));var E,j="0.3.8",O="w:"+j,K="FIS_v2",A=((E={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',E["not-registered"]="Firebase Installation is not registered.",E["installation-not-found"]="Firebase Installation not found.",E["request-failed"]='{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',E["app-offline"]="Could not process request. Application offline.",E["delete-pending-registration"]="Can't delete installation while there is a pending registration request.",E),V=new l("installations","Installations",A);function q(e){return e instanceof u&&e.code.includes("request-failed")}function U(e){return"https://firebaseinstallations.googleapis.com/v1/projects/"+e.projectId+"/installations"}function W(e){return{token:e.token,requestStatus:2,expiresIn:function(e){return Number(e.replace("s","000"))}(e.expiresIn),creationTime:Date.now()}}function F(e,t){return i(this,void 0,void 0,(function(){var n,r;return o(this,(function(i){switch(i.label){case 0:return[4,t.json()];case 1:return n=i.sent(),r=n.error,[2,V.create("request-failed",{requestName:e,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})]}}))}))}function L(e){var t=e.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function R(e,t){var n=t.refreshToken,r=L(e);return r.append("Authorization",function(e){return K+" "+e}(n)),r}function B(e){return i(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return[4,e()];case 1:return 500<=(t=n.sent()).status&&t.status<600?[2,e()]:[2,t]}}))}))}function H(e){return new Promise((function(t){setTimeout(t,e)}))}var $=/^[cdef][\w-]{21}$/;function G(){try{var e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;var t=function(e){return function(e){return btoa(String.fromCharCode.apply(String,a(e))).replace(/\+/g,"-").replace(/\//g,"_")}(e).substr(0,22)}(e);return $.test(t)?t:""}catch(e){return""}}var z,J,Y="firebase-installations-store",Z=null;function Q(){return Z=Z||function(e,t,n){var r=k(indexedDB,"open",["firebase-installations-database",1]),i=r.request;return i&&(i.onupgradeneeded=function(e){n&&n(new N(i.result,e.oldVersion,i.transaction))}),r.then((function(e){return new x(e)}))}(0,0,(function(e){switch(e.oldVersion){case 0:e.createObjectStore(Y)}}))}function X(e,t){return i(this,void 0,void 0,(function(){var n,r,i;return o(this,(function(o){switch(o.label){case 0:return n=ne(e),[4,Q()];case 1:return r=o.sent(),[4,(i=r.transaction(Y,"readwrite")).objectStore(Y).put(t,n)];case 2:return o.sent(),[4,i.complete];case 3:return o.sent(),[2,t]}}))}))}function ee(e){return i(this,void 0,void 0,(function(){var t,n,r;return o(this,(function(i){switch(i.label){case 0:return t=ne(e),[4,Q()];case 1:return n=i.sent(),[4,(r=n.transaction(Y,"readwrite")).objectStore(Y).delete(t)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}}))}))}function te(e,t){return i(this,void 0,void 0,(function(){var n,r,i,s,a,c;return o(this,(function(o){switch(o.label){case 0:return n=ne(e),[4,Q()];case 1:return r=o.sent(),i=r.transaction(Y,"readwrite"),[4,(s=i.objectStore(Y)).get(n)];case 2:return a=o.sent(),void 0!==(c=t(a))?[3,4]:[4,s.delete(n)];case 3:return o.sent(),[3,6];case 4:return[4,s.put(c,n)];case 5:o.sent(),o.label=6;case 6:return[4,i.complete];case 7:return o.sent(),[2,c]}}))}))}function ne(e){return e.appName+"!"+e.appId}function re(e){return i(this,void 0,void 0,(function(){var t,n,r;return o(this,(function(s){switch(s.label){case 0:return[4,te(e,(function(n){var r=function(e){return oe(e||{fid:G(),registrationStatus:0})}(n),s=function(e,t){if(0!==t.registrationStatus)return 1===t.registrationStatus?{installationEntry:t,registrationPromise:function(e){return i(this,void 0,void 0,(function(){var t,n,r,i;return o(this,(function(o){switch(o.label){case 0:return[4,ie(e)];case 1:t=o.sent(),o.label=2;case 2:return 1!==t.registrationStatus?[3,5]:[4,H(100)];case 3:return o.sent(),[4,ie(e)];case 4:return t=o.sent(),[3,2];case 5:return 0!==t.registrationStatus?[3,7]:[4,re(e)];case 6:return n=o.sent(),r=n.installationEntry,(i=n.registrationPromise)?[2,i]:[2,r];case 7:return[2,t]}}))}))}(e)}:{installationEntry:t};if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(V.create("app-offline"))};var n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=function(e,t){return i(this,void 0,void 0,(function(){var n,r;return o(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,7]),[4,function(e,t){var n=t.fid;return i(this,void 0,void 0,(function(){var t,r,i,s,a,c;return o(this,(function(o){switch(o.label){case 0:return t=U(e),r=L(e),i={fid:n,authVersion:K,appId:e.appId,sdkVersion:O},s={method:"POST",headers:r,body:JSON.stringify(i)},[4,B((function(){return fetch(t,s)}))];case 1:return(a=o.sent()).ok?[4,a.json()]:[3,3];case 2:return[2,{fid:(c=o.sent()).fid||n,registrationStatus:2,refreshToken:c.refreshToken,authToken:W(c.authToken)}];case 3:return[4,F("Create Installation",a)];case 4:throw o.sent()}}))}))}(e,t)];case 1:return n=s.sent(),[2,X(e,n)];case 2:return q(r=s.sent())&&409===r.serverCode?[4,ee(e)]:[3,4];case 3:return s.sent(),[3,6];case 4:return[4,X(e,{fid:t.fid,registrationStatus:0})];case 5:s.sent(),s.label=6;case 6:throw r;case 7:return[2]}}))}))}(e,n);return{installationEntry:n,registrationPromise:r}}(e,r);return t=s.registrationPromise,s.installationEntry}))];case 1:return""!==(n=s.sent()).fid?[3,3]:(r={},[4,t]);case 2:return[2,(r.installationEntry=s.sent(),r)];case 3:return[2,{installationEntry:n,registrationPromise:t}]}}))}))}function ie(e){return te(e,(function(e){if(!e)throw V.create("installation-not-found");return oe(e)}))}function oe(e){return function(e){return 1===e.registrationStatus&&e.registrationTime+1e4<Date.now()}(e)?{fid:e.fid,registrationStatus:0}:e}function se(e,t){var n=e.appConfig,r=e.platformLoggerProvider;return i(this,void 0,void 0,(function(){var e,i,s,a,c,u;return o(this,(function(o){switch(o.label){case 0:return e=function(e,t){var n=t.fid;return U(e)+"/"+n+"/authTokens:generate"}(n,t),i=R(n,t),(s=r.getImmediate({optional:!0}))&&i.append("x-firebase-client",s.getPlatformInfoString()),a={installation:{sdkVersion:O}},c={method:"POST",headers:i,body:JSON.stringify(a)},[4,B((function(){return fetch(e,c)}))];case 1:return(u=o.sent()).ok?[4,u.json()]:[3,3];case 2:return[2,W(o.sent())];case 3:return[4,F("Generate Auth Token",u)];case 4:throw o.sent()}}))}))}function ae(e,t){return void 0===t&&(t=!1),i(this,void 0,void 0,(function(){var n,s,a;return o(this,(function(c){switch(c.label){case 0:return[4,te(e.appConfig,(function(s){if(!ue(s))throw V.create("not-registered");var a=s.authToken;if(!t&&function(e){return 2===e.requestStatus&&!function(e){var t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+36e5}(e)}(a))return s;if(1===a.requestStatus)return n=function(e,t){return i(this,void 0,void 0,(function(){var n,r;return o(this,(function(i){switch(i.label){case 0:return[4,ce(e.appConfig)];case 1:n=i.sent(),i.label=2;case 2:return 1!==n.authToken.requestStatus?[3,5]:[4,H(100)];case 3:return i.sent(),[4,ce(e.appConfig)];case 4:return n=i.sent(),[3,2];case 5:return 0===(r=n.authToken).requestStatus?[2,ae(e,t)]:[2,r]}}))}))}(e,t),s;if(!navigator.onLine)throw V.create("app-offline");var c=function(e){var t={requestStatus:1,requestTime:Date.now()};return r(r({},e),{authToken:t})}(s);return n=function(e,t){return i(this,void 0,void 0,(function(){var n,i,s;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,8]),[4,se(e,t)];case 1:return n=o.sent(),s=r(r({},t),{authToken:n}),[4,X(e.appConfig,s)];case 2:return o.sent(),[2,n];case 3:return!q(i=o.sent())||401!==i.serverCode&&404!==i.serverCode?[3,5]:[4,ee(e.appConfig)];case 4:return o.sent(),[3,7];case 5:return s=r(r({},t),{authToken:{requestStatus:0}}),[4,X(e.appConfig,s)];case 6:o.sent(),o.label=7;case 7:throw i;case 8:return[2]}}))}))}(e,c),c}))];case 1:return s=c.sent(),n?[4,n]:[3,3];case 2:return a=c.sent(),[3,4];case 3:a=s.authToken,c.label=4;case 4:return[2,a]}}))}))}function ce(e){return te(e,(function(e){if(!ue(e))throw V.create("not-registered");return function(e){return 1===e.requestStatus&&e.requestTime+1e4<Date.now()}(e.authToken)?r(r({},e),{authToken:{requestStatus:0}}):e}))}function ue(e){return void 0!==e&&2===e.registrationStatus}function fe(e,t){return i(this,void 0,void 0,(function(){var n,r,i,s;return o(this,(function(o){switch(o.label){case 0:return n=function(e,t){var n=t.fid;return U(e)+"/"+n}(e,t),r=R(e,t),i={method:"DELETE",headers:r},[4,B((function(){return fetch(n,i)}))];case 1:return(s=o.sent()).ok?[3,3]:[4,F("Delete Installation",s)];case 2:throw o.sent();case 3:return[2]}}))}))}function le(e){var t,n;if(!e||!e.options)throw pe("App Configuration");if(!e.name)throw pe("App Name");try{for(var r=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}(["projectId","apiKey","appId"]),i=r.next();!i.done;i=r.next()){var o=i.value;if(!e.options[o])throw pe(o)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}function pe(e){return V.create("missing-app-config-values",{valueName:e})}(z=e).INTERNAL.registerComponent(new y("installations",(function(e){var t=e.getProvider("app").getImmediate(),n={appConfig:le(t),platformLoggerProvider:e.getProvider("platform-logger")};return{app:t,getId:function(){return function(e){return i(this,void 0,void 0,(function(){var t,n,r;return o(this,(function(i){switch(i.label){case 0:return[4,re(e.appConfig)];case 1:return t=i.sent(),n=t.installationEntry,(r=t.registrationPromise)?r.catch(console.error):ae(e).catch(console.error),[2,n.fid]}}))}))}(n)},getToken:function(e){return function(e,t){return void 0===t&&(t=!1),i(this,void 0,void 0,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,function(e){return i(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return[4,re(e)];case 1:return(t=n.sent().registrationPromise)?[4,t]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))}(e.appConfig)];case 1:return n.sent(),[4,ae(e,t)];case 2:return[2,n.sent().token]}}))}))}(n,e)},delete:function(){return function(e){return i(this,void 0,void 0,(function(){var t,n;return o(this,(function(r){switch(r.label){case 0:return[4,te(t=e.appConfig,(function(e){if(!e||0!==e.registrationStatus)return e}))];case 1:if(!(n=r.sent()))return[3,6];if(1!==n.registrationStatus)return[3,2];throw V.create("delete-pending-registration");case 2:if(2!==n.registrationStatus)return[3,6];if(navigator.onLine)return[3,3];throw V.create("app-offline");case 3:return[4,fe(t,n)];case 4:return r.sent(),[4,ee(t)];case 5:r.sent(),r.label=6;case 6:return[2]}}))}))}(n)}}}),"PUBLIC")),z.registerVersion("@firebase/installations",j);var de,he,ve=((J={})["only-available-in-window"]="This method is available in a Window context.",J["only-available-in-sw"]="This method is available in a service worker context.",J["should-be-overriden"]="This method should be overriden by extended classes.",J["bad-sender-id"]="Please ensure that 'messagingSenderId' is set correctly in the options passed into firebase.initializeApp().",J["permission-default"]="The required permissions were not granted and dismissed instead.",J["permission-blocked"]="The required permissions were not granted and blocked instead.",J["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",J["notifications-blocked"]="Notifications have been blocked.",J["failed-serviceworker-registration"]="We are unable to register the default service worker. {$browserErrorMessage}",J["sw-registration-expected"]="A service worker registration was the expected input.",J["get-subscription-failed"]="There was an error when trying to get any existing Push Subscriptions.",J["invalid-saved-token"]="Unable to access details of the saved token.",J["sw-reg-redundant"]="The service worker being used for push was made redundant.",J["token-subscribe-failed"]="A problem occured while subscribing the user to FCM: {$errorInfo}",J["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",J["token-unsubscribe-failed"]="A problem occured while unsubscribing the user from FCM: {$errorInfo}",J["token-update-failed"]="A problem occured while updating the user from FCM: {$errorInfo}",J["token-update-no-token"]="FCM returned no token when updating the user to push.",J["use-sw-before-get-token"]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",J["invalid-delete-token"]="You must pass a valid token into deleteToken(), i.e. the token from getToken().",J["delete-token-not-found"]="The deletion attempt for token could not be performed as the token was not found.",J["delete-scope-not-found"]="The deletion attempt for service worker scope could not be performed as the scope was not found.",J["bg-handler-function-expected"]="The input to setBackgroundMessageHandler() must be a function.",J["no-window-client-to-msg"]="An attempt was made to message a non-existant window client.",J["unable-to-resubscribe"]="There was an error while re-subscribing the FCM token for push messaging. Will have to resubscribe the user on next visit. {$errorInfo}",J["no-fcm-token-for-resubscribe"]="Could not find an FCM token and as a result, unable to resubscribe. Will have to resubscribe the user on next visit.",J["failed-to-delete-token"]="Unable to delete the currently saved token.",J["no-sw-in-reg"]="Even though the service worker registration was successful, there was a problem accessing the service worker itself.",J["bad-scope"]="The service worker scope must be a string with at least one character.",J["bad-vapid-key"]="The public VAPID key is not a Uint8Array with 65 bytes.",J["bad-subscription"]="The subscription must be a valid PushSubscription.",J["bad-token"]="The FCM Token used for storage / lookup was not a valid token string.",J["failed-delete-vapid-key"]="The VAPID key could not be deleted.",J["invalid-public-vapid-key"]="The public VAPID key must be a string.",J["use-public-key-before-get-token"]="The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used.",J["public-vapid-key-decryption-failed"]="The public VAPID key did not equal 65 bytes when decrypted.",J),be=new l("messaging","Messaging",ve),ge=new Uint8Array([4,51,148,247,223,161,235,177,220,3,162,94,21,113,219,72,211,46,237,237,178,52,219,183,71,58,12,143,196,204,225,111,60,140,132,223,171,182,102,62,242,12,212,139,254,227,249,118,47,20,28,99,8,106,111,45,177,26,149,176,206,55,192,156,110]),ye="google.c.a.c_id";function we(e,t){if(null==e||null==t)return!1;if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(var n=new DataView(e),r=new DataView(t),i=0;i<e.byteLength;i++)if(n.getUint8(i)!==r.getUint8(i))return!1;return!0}function me(e){return function(e){var t=new Uint8Array(e);return btoa(String.fromCharCode.apply(String,a(t)))}(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}(he=de=de||{}).PUSH_MSG_RECEIVED="push-msg-received",he.NOTIFICATION_CLICKED="notification-clicked";var ke=(Se.prototype.getToken=function(e,t,n){return i(this,void 0,void 0,(function(){var r,i,s,a,c,u;return o(this,(function(o){switch(o.label){case 0:return[4,_e(e)];case 1:r=o.sent(),i=Pe(t,n),s={method:"POST",headers:r,body:JSON.stringify(i)},o.label=2;case 2:return o.trys.push([2,5,,6]),[4,fetch(Te(e.app),s)];case 3:return[4,o.sent().json()];case 4:return a=o.sent(),[3,6];case 5:throw c=o.sent(),be.create("token-subscribe-failed",{errorInfo:c});case 6:if(a.error)throw u=a.error.message,be.create("token-subscribe-failed",{errorInfo:u});if(!a.token)throw be.create("token-subscribe-no-token");return[2,a.token]}}))}))},Se.prototype.updateToken=function(e,t,n,r){return i(this,void 0,void 0,(function(){var i,s,a,c,u,f;return o(this,(function(o){switch(o.label){case 0:return[4,_e(t)];case 1:i=o.sent(),s=Pe(n,r),a={method:"PATCH",headers:i,body:JSON.stringify(s)},o.label=2;case 2:return o.trys.push([2,5,,6]),[4,fetch(Te(t.app)+"/"+e.fcmToken,a)];case 3:return[4,o.sent().json()];case 4:return c=o.sent(),[3,6];case 5:throw u=o.sent(),be.create("token-update-failed",{errorInfo:u});case 6:if(c.error)throw f=c.error.message,be.create("token-update-failed",{errorInfo:f});if(!c.token)throw be.create("token-update-no-token");return[2,c.token]}}))}))},Se.prototype.deleteToken=function(e,t){return i(this,void 0,void 0,(function(){var n,r,i,s,a;return o(this,(function(o){switch(o.label){case 0:return[4,_e(e)];case 1:n=o.sent(),r={method:"DELETE",headers:n},o.label=2;case 2:return o.trys.push([2,5,,6]),[4,fetch(Te(e.app)+"/"+t.fcmToken,r)];case 3:return[4,o.sent().json()];case 4:if((i=o.sent()).error)throw s=i.error.message,be.create("token-unsubscribe-failed",{errorInfo:s});return[3,6];case 5:throw a=o.sent(),be.create("token-unsubscribe-failed",{errorInfo:a});case 6:return[2]}}))}))},Se);function Se(){}function Te(e){return"https://fcmregistrations.googleapis.com/v1/projects/"+e.options.projectId+"/registrations"}function _e(e){var t=e.app,n=e.installations;return i(this,void 0,void 0,(function(){var e;return o(this,(function(r){switch(r.label){case 0:return[4,n.getToken()];case 1:return e=r.sent(),[2,new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.options.apiKey,"x-goog-firebase-installations-auth":"FIS "+e})]}}))}))}function Pe(e,t){var n=me(e.getKey("p256dh")),r=me(e.getKey("auth")),i={web:{endpoint:e.endpoint,p256dh:n,auth:r}};return we(t.buffer,ge.buffer)||(i.web.applicationPubKey=me(t)),i}function Ie(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}var De="undefined",Ce="fcm_token_object_Store";var Me=(Ne.prototype.get=function(e){return this.createTransaction((function(t){return t.get(e)}))},Ne.prototype.getIndex=function(e,t){return this.createTransaction((function(n){return n.index(e).get(t)}))},Ne.prototype.put=function(e){return this.createTransaction((function(t){return t.put(e)}),"readwrite")},Ne.prototype.delete=function(e){return this.createTransaction((function(t){return t.delete(e)}),"readwrite")},Ne.prototype.closeDatabase=function(){return i(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return this.dbPromise?[4,this.dbPromise]:[3,2];case 1:e.sent().close(),this.dbPromise=null,e.label=2;case 2:return[2]}}))}))},Ne.prototype.createTransaction=function(e,t){return void 0===t&&(t="readonly"),i(this,void 0,void 0,(function(){var n,r,i,s;return o(this,(function(o){switch(o.label){case 0:return[4,this.getDb()];case 1:return n=o.sent(),r=n.transaction(this.objectStoreName,t),i=r.objectStore(this.objectStoreName),[4,function(e){return new Promise((function(t,n){e.onsuccess=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}(e(i))];case 2:return s=o.sent(),[2,new Promise((function(e,t){r.oncomplete=function(){e(s)},r.onerror=function(){t(r.error)}}))]}}))}))},Ne.prototype.getDb=function(){var e=this;return this.dbPromise||(this.dbPromise=new Promise((function(t,n){var r=indexedDB.open(e.dbName,e.dbVersion);r.onsuccess=function(){t(r.result)},r.onerror=function(){e.dbPromise=null,n(r.error)},r.onupgradeneeded=function(t){return e.onDbUpgrade(r,t)}}))),this.dbPromise},Ne);function Ne(){this.dbPromise=null}var xe,Ee=(n(je,xe=Me),je.prototype.onDbUpgrade=function(e,t){var n=e.result;switch(t.oldVersion){case 0:(o=n.createObjectStore(this.objectStoreName,{keyPath:"swScope"})).createIndex("fcmSenderId","fcmSenderId",{unique:!1}),o.createIndex("fcmToken","fcmToken",{unique:!0});case 1:!function(e){var t=indexedDB.open(De);t.onerror=function(e){},t.onsuccess=function(n){!function(e,t){if(e.objectStoreNames.contains(Ce)){var n=e.transaction(Ce).objectStore(Ce),r=new ke,i=n.openCursor();i.onerror=function(e){console.warn("Unable to cleanup old IDB.",e)},i.onsuccess=function(){var n=i.result;if(n){var o=n.value;r.deleteToken(t,o),n.continue()}else e.close(),indexedDB.deleteDatabase(De)}}}(t.result,e)}}(this.services);case 2:var i=(o=e.transaction.objectStore(this.objectStoreName)).openCursor();i.onsuccess=function(){var e=i.result;if(e){var t=e.value,n=r({},t);t.createTime||(n.createTime=Date.now()),"string"==typeof t.vapidKey&&(n.vapidKey=Ie(t.vapidKey)),"string"==typeof t.auth&&(n.auth=Ie(t.auth).buffer),"string"==typeof t.auth&&(n.p256dh=Ie(t.p256dh).buffer),"string"==typeof t.fcmPushSet&&delete n.fcmPushSet,e.update(n),e.continue()}};break;case 3:var o,s=(o=e.transaction.objectStore(this.objectStoreName)).openCursor();s.onsuccess=function(){var e=s.result;if(e){var t=e.value,n=r({},t);"string"==typeof t.fcmPushSet&&delete n.fcmPushSet,e.update(n),e.continue()}}}},je.prototype.getTokenDetailsFromToken=function(e){return i(this,void 0,void 0,(function(){return o(this,(function(t){if(!e)throw be.create("bad-token");return Oe({fcmToken:e}),[2,this.getIndex("fcmToken",e)]}))}))},je.prototype.getTokenDetailsFromSWScope=function(e){return i(this,void 0,void 0,(function(){return o(this,(function(t){if(!e)throw be.create("bad-scope");return Oe({swScope:e}),[2,this.get(e)]}))}))},je.prototype.saveTokenDetails=function(e){return i(this,void 0,void 0,(function(){return o(this,(function(t){if(!e.swScope)throw be.create("bad-scope");if(!e.vapidKey)throw be.create("bad-vapid-key");if(!e.endpoint||!e.auth||!e.p256dh)throw be.create("bad-subscription");if(!e.fcmSenderId)throw be.create("bad-sender-id");if(!e.fcmToken)throw be.create("bad-token");return Oe(e),[2,this.put(e)]}))}))},je.prototype.deleteToken=function(e){return i(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return"string"!=typeof e||0===e.length?[2,Promise.reject(be.create("invalid-delete-token"))]:[4,this.getTokenDetailsFromToken(e)];case 1:if(!(t=n.sent()))throw be.create("delete-token-not-found");return[4,this.delete(t.swScope)];case 2:return n.sent(),[2,t]}}))}))},je);function je(e){var t=xe.call(this)||this;return t.services=e,t.dbName="fcm_token_details_db",t.dbVersion=4,t.objectStoreName="fcm_token_object_Store",t}function Oe(e){if(e.fcmToken&&("string"!=typeof e.fcmToken||0===e.fcmToken.length))throw be.create("bad-token");if(e.swScope&&("string"!=typeof e.swScope||0===e.swScope.length))throw be.create("bad-scope");if(e.vapidKey&&(!(e.vapidKey instanceof Uint8Array)||65!==e.vapidKey.length))throw be.create("bad-vapid-key");if(e.endpoint&&("string"!=typeof e.endpoint||0===e.endpoint.length))throw be.create("bad-subscription");if(e.auth&&!(e.auth instanceof ArrayBuffer))throw be.create("bad-subscription");if(e.p256dh&&!(e.p256dh instanceof ArrayBuffer))throw be.create("bad-subscription");if(e.fcmSenderId&&("string"!=typeof e.fcmSenderId||0===e.fcmSenderId.length))throw be.create("bad-sender-id")}var Ke,Ae=(n(Ve,Ke=Me),Ve.prototype.onDbUpgrade=function(e){e.result.createObjectStore(this.objectStoreName,{keyPath:"swScope"})},Ve.prototype.getVapidFromSWScope=function(e){return i(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:if("string"!=typeof e||0===e.length)throw be.create("bad-scope");return[4,this.get(e)];case 1:return[2,(t=n.sent())?t.vapidKey:void 0]}}))}))},Ve.prototype.saveVapidDetails=function(e,t){return i(this,void 0,void 0,(function(){var n;return o(this,(function(r){if("string"!=typeof e||0===e.length)throw be.create("bad-scope");if(null===t||65!==t.length)throw be.create("bad-vapid-key");return n={swScope:e,vapidKey:t},[2,this.put(n)]}))}))},Ve.prototype.deleteVapidDetails=function(e){return i(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return[4,this.getVapidFromSWScope(e)];case 1:if(!(t=n.sent()))throw be.create("delete-scope-not-found");return[4,this.delete(e)];case 2:return n.sent(),[2,t]}}))}))},Ve);function Ve(){var e=null!==Ke&&Ke.apply(this,arguments)||this;return e.dbName="fcm_vapid_details_db",e.dbVersion=1,e.objectStoreName="fcm_vapid_object_Store",e}var qe=(Ue.prototype.getToken=function(){return i(this,void 0,void 0,(function(){var e,t,n,r,i;return o(this,(function(o){switch(o.label){case 0:return"default"!==(e=this.getNotificationPermission())?[3,2]:[4,this.requestNotificationPermission()];case 1:e=o.sent(),o.label=2;case 2:if("granted"!==e)throw be.create("notifications-blocked");return[4,this.getSWRegistration_()];case 3:return t=o.sent(),[4,this.getPublicVapidKey_()];case 4:return n=o.sent(),[4,this.getPushSubscription(t,n)];case 5:return r=o.sent(),[4,this.tokenDetailsModel.getTokenDetailsFromSWScope(t.scope)];case 6:return(i=o.sent())?[2,this.manageExistingToken(t,r,n,i)]:[2,this.getNewToken(t,r,n)]}}))}))},Ue.prototype.manageExistingToken=function(e,t,n,r){return i(this,void 0,void 0,(function(){return o(this,(function(i){switch(i.label){case 0:return function(e,t,n){if(!n.vapidKey||!we(t.buffer,n.vapidKey.buffer))return!1;var r=e.endpoint===n.endpoint,i=we(e.getKey("auth"),n.auth),o=we(e.getKey("p256dh"),n.p256dh);return r&&i&&o}(t,n,r)?Date.now()<r.createTime+6048e5?[2,r.fcmToken]:[2,this.updateToken(e,t,n,r)]:[3,1];case 1:return[4,this.deleteTokenFromDB(r.fcmToken)];case 2:return i.sent(),[2,this.getNewToken(e,t,n)];case 3:return[2]}}))}))},Ue.prototype.updateToken=function(e,t,n,r){return i(this,void 0,void 0,(function(){var i,s,a;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,4,,6]),[4,this.subscriptionManager.updateToken(r,this.services,t,n)];case 1:return i=o.sent(),s={swScope:e.scope,vapidKey:n,fcmSenderId:this.services.app.options.messagingSenderId,fcmToken:i,createTime:Date.now(),endpoint:t.endpoint,auth:t.getKey("auth"),p256dh:t.getKey("p256dh")},[4,this.tokenDetailsModel.saveTokenDetails(s)];case 2:return o.sent(),[4,this.vapidDetailsModel.saveVapidDetails(e.scope,n)];case 3:return o.sent(),[2,i];case 4:return a=o.sent(),[4,this.deleteToken(r.fcmToken)];case 5:throw o.sent(),a;case 6:return[2]}}))}))},Ue.prototype.getNewToken=function(e,t,n){return i(this,void 0,void 0,(function(){var r,i;return o(this,(function(o){switch(o.label){case 0:return[4,this.subscriptionManager.getToken(this.services,t,n)];case 1:return r=o.sent(),i={swScope:e.scope,vapidKey:n,fcmSenderId:this.app.options.messagingSenderId,fcmToken:r,createTime:Date.now(),endpoint:t.endpoint,auth:t.getKey("auth"),p256dh:t.getKey("p256dh")},[4,this.tokenDetailsModel.saveTokenDetails(i)];case 2:return o.sent(),[4,this.vapidDetailsModel.saveVapidDetails(e.scope,n)];case 3:return o.sent(),[2,r]}}))}))},Ue.prototype.deleteToken=function(e){return i(this,void 0,void 0,(function(){var t,n;return o(this,(function(r){switch(r.label){case 0:return[4,this.deleteTokenFromDB(e)];case 1:return r.sent(),[4,this.getSWRegistration_()];case 2:return(t=r.sent())?[4,t.pushManager.getSubscription()]:[3,4];case 3:if(n=r.sent())return[2,n.unsubscribe()];r.label=4;case 4:return[2,!0]}}))}))},Ue.prototype.deleteTokenFromDB=function(e){return i(this,void 0,void 0,(function(){var t,n;return o(this,(function(r){switch(r.label){case 0:return[4,this.tokenDetailsModel.deleteToken(e)];case 1:t=r.sent(),r.label=2;case 2:return r.trys.push([2,4,,5]),[4,this.subscriptionManager.deleteToken(this.services,t)];case 3:return r.sent(),[3,5];case 4:return n=r.sent(),console.error(n),[3,5];case 5:return[2]}}))}))},Ue.prototype.getPushSubscription=function(e,t){return i(this,void 0,void 0,(function(){var n;return o(this,(function(r){switch(r.label){case 0:return[4,e.pushManager.getSubscription()];case 1:return(n=r.sent())?[2,n]:[2,e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:t})]}}))}))},Ue.prototype.requestPermission=function(){throw be.create("only-available-in-window")},Ue.prototype.useServiceWorker=function(e){throw be.create("only-available-in-window")},Ue.prototype.usePublicVapidKey=function(e){throw be.create("only-available-in-window")},Ue.prototype.onMessage=function(e,t,n){throw be.create("only-available-in-window")},Ue.prototype.onTokenRefresh=function(e,t,n){throw be.create("only-available-in-window")},Ue.prototype.setBackgroundMessageHandler=function(e){throw be.create("only-available-in-sw")},Ue.prototype.delete=function(){return i(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,Promise.all([this.tokenDetailsModel.closeDatabase(),this.vapidDetailsModel.closeDatabase()])];case 1:return e.sent(),[2]}}))}))},Ue.prototype.getNotificationPermission=function(){return Notification.permission},Ue.prototype.requestNotificationPermission=function(){return i(this,void 0,void 0,(function(){return o(this,(function(e){return Notification.requestPermission?[2,Notification.requestPermission()]:[2,Notification.permission]}))}))},Ue.prototype.getTokenDetailsModel=function(){return this.tokenDetailsModel},Ue.prototype.getVapidDetailsModel=function(){return this.vapidDetailsModel},Ue.prototype.getSubscriptionManager=function(){return this.subscriptionManager},Ue);function Ue(e){var t=this;this.services=e,this.vapidDetailsModel=new Ae,this.subscriptionManager=new ke;var n=e.app;if(!(this.app=n).options.messagingSenderId||"string"!=typeof n.options.messagingSenderId)throw be.create("bad-sender-id");this.INTERNAL={delete:function(){return t.delete()}},this.tokenDetailsModel=new Ee(e)}var We,Fe="FCM_MSG",Le=(n(Re,We=qe),Re.prototype.onPush=function(e){e.waitUntil(this.onPush_(e))},Re.prototype.onSubChange=function(e){e.waitUntil(this.onSubChange_(e))},Re.prototype.onNotificationClick=function(e){e.waitUntil(this.onNotificationClick_(e))},Re.prototype.onPush_=function(e){return i(this,void 0,void 0,(function(){var t,n,r,i,s,a;return o(this,(function(o){switch(o.label){case 0:if(!e.data)return[2];try{t=e.data.json()}catch(o){return[2]}return[4,this.hasVisibleClients_()];case 1:return o.sent()?[2,this.sendMessageToWindowClients_(t)]:(n=this.getNotificationData_(t))?(r=n.title||"",[4,this.getSWRegistration_()]):[3,3];case 2:return i=o.sent(),s=n.actions,a=Notification.maxActions,s&&a&&s.length>a&&console.warn("This browser only supports "+a+" actions.The remaining actions will not be displayed."),[2,i.showNotification(r,n)];case 3:return this.bgMessageHandler?[4,this.bgMessageHandler(t)]:[3,5];case 4:return o.sent(),[2];case 5:return[2]}}))}))},Re.prototype.onSubChange_=function(e){return i(this,void 0,void 0,(function(){var e,t,n,r;return o(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.getSWRegistration_()];case 1:return e=i.sent(),[3,3];case 2:throw t=i.sent(),be.create("unable-to-resubscribe",{errorInfo:t});case 3:return i.trys.push([3,5,,8]),[4,e.pushManager.getSubscription()];case 4:return i.sent(),[3,8];case 5:return n=i.sent(),[4,this.getTokenDetailsModel().getTokenDetailsFromSWScope(e.scope)];case 6:if(!(r=i.sent()))throw n;return[4,this.deleteToken(r.fcmToken)];case 7:throw i.sent(),n;case 8:return[2]}}))}))},Re.prototype.onNotificationClick_=function(e){return i(this,void 0,void 0,(function(){var t,n,r,i;return o(this,(function(o){switch(o.label){case 0:if(!(e.notification&&e.notification.data&&e.notification.data[Fe]))return[2];if(e.action)return[2];if(e.stopImmediatePropagation(),e.notification.close(),!(t=e.notification.data[Fe]).notification)return[2];if(!(n=t.fcmOptions&&t.fcmOptions.link||t.notification.click_action)){if(!t.data||!(ye in t.data))return[2];n=self.location.origin}return[4,this.getWindowClient_(n)];case 1:return(r=o.sent())?[3,4]:[4,self.clients.openWindow(n)];case 2:return r=o.sent(),[4,new Promise((function(e){setTimeout(e,3e3)}))];case 3:return o.sent(),[3,6];case 4:return[4,r.focus()];case 5:r=o.sent(),o.label=6;case 6:return r?(delete t.notification,delete t.fcmOptions,i=He(de.NOTIFICATION_CLICKED,t),[2,this.attemptToMessageClient_(r,i)]):[2]}}))}))},Re.prototype.getNotificationData_=function(e){var t;if(e&&"object"==typeof e.notification){var n=r({},e.notification);return n.data=r(r({},e.notification.data),((t={})[Fe]=e,t)),n}},Re.prototype.setBackgroundMessageHandler=function(e){if(!e||"function"!=typeof e)throw be.create("bg-handler-function-expected");this.bgMessageHandler=e},Re.prototype.getWindowClient_=function(e){return i(this,void 0,void 0,(function(){var t,n,r,i;return o(this,(function(o){switch(o.label){case 0:return t=new URL(e,self.location.href).href,[4,Be()];case 1:for(n=o.sent(),r=null,i=0;i<n.length;i++)if(new URL(n[i].url,self.location.href).href===t){r=n[i];break}return[2,r]}}))}))},Re.prototype.attemptToMessageClient_=function(e,t){return i(this,void 0,void 0,(function(){return o(this,(function(n){if(!e)throw be.create("no-window-client-to-msg");return e.postMessage(t),[2]}))}))},Re.prototype.hasVisibleClients_=function(){return i(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,Be()];case 1:return[2,e.sent().some((function(e){return"visible"===e.visibilityState&&!e.url.startsWith("chrome-extension://")}))]}}))}))},Re.prototype.sendMessageToWindowClients_=function(e){return i(this,void 0,void 0,(function(){var t,n,r=this;return o(this,(function(i){switch(i.label){case 0:return[4,Be()];case 1:return t=i.sent(),n=He(de.PUSH_MSG_RECEIVED,e),[4,Promise.all(t.map((function(e){return r.attemptToMessageClient_(e,n)})))];case 2:return i.sent(),[2]}}))}))},Re.prototype.getSWRegistration_=function(){return i(this,void 0,void 0,(function(){return o(this,(function(e){return[2,self.registration]}))}))},Re.prototype.getPublicVapidKey_=function(){return i(this,void 0,void 0,(function(){var e,t;return o(this,(function(n){switch(n.label){case 0:return[4,this.getSWRegistration_()];case 1:if(!(e=n.sent()))throw be.create("sw-registration-expected");return[4,this.getVapidDetailsModel().getVapidFromSWScope(e.scope)];case 2:return null==(t=n.sent())?[2,ge]:[2,t]}}))}))},Re);function Re(e){var t=We.call(this,e)||this;return t.bgMessageHandler=null,self.addEventListener("push",(function(e){t.onPush(e)})),self.addEventListener("pushsubscriptionchange",(function(e){t.onSubChange(e)})),self.addEventListener("notificationclick",(function(e){t.onNotificationClick(e)})),t}function Be(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function He(e,t){return{firebaseMessagingType:e,firebaseMessagingData:t}}var $e,Ge,ze,Je=(n(Ye,$e=qe),Ye.prototype.requestPermission=function(){return i(this,void 0,void 0,(function(){var e;return o(this,(function(t){switch(t.label){case 0:return"granted"===Notification.permission?[2]:[4,Notification.requestPermission()];case 1:if("granted"===(e=t.sent()))return[2];throw"denied"===e?be.create("permission-blocked"):be.create("permission-default")}}))}))},Ye.prototype.useServiceWorker=function(e){if(!(e instanceof ServiceWorkerRegistration))throw be.create("sw-registration-expected");if(null!=this.registrationToUse)throw be.create("use-sw-before-get-token");this.registrationToUse=e},Ye.prototype.usePublicVapidKey=function(e){if("string"!=typeof e)throw be.create("invalid-public-vapid-key");if(null!=this.publicVapidKeyToUse)throw be.create("use-public-key-before-get-token");var t=Ie(e);if(65!==t.length)throw be.create("public-vapid-key-decryption-failed");this.publicVapidKeyToUse=t},Ye.prototype.onMessage=function(e,t,n){return"function"==typeof e?this.onMessageInternal(e,t,n):this.onMessageInternal(e)},Ye.prototype.onTokenRefresh=function(e,t,n){return"function"==typeof e?this.onTokenRefreshInternal(e,t,n):this.onTokenRefreshInternal(e)},Ye.prototype.waitForRegistrationToActivate_=function(e){var t=e.installing||e.waiting||e.active;return new Promise((function(n,r){if(t)if("activated"!==t.state)if("redundant"!==t.state){var i=function(){if("activated"===t.state)n(e);else{if("redundant"!==t.state)return;r(be.create("sw-reg-redundant"))}t.removeEventListener("statechange",i)};t.addEventListener("statechange",i)}else r(be.create("sw-reg-redundant"));else n(e);else r(be.create("no-sw-in-reg"))}))},Ye.prototype.getSWRegistration_=function(){var e=this;return this.registrationToUse?this.waitForRegistrationToActivate_(this.registrationToUse):(this.registrationToUse=null,navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"}).catch((function(e){throw be.create("failed-serviceworker-registration",{browserErrorMessage:e.message})})).then((function(t){return e.waitForRegistrationToActivate_(t).then((function(){return(e.registrationToUse=t).update(),t}))})))},Ye.prototype.getPublicVapidKey_=function(){return i(this,void 0,void 0,(function(){return o(this,(function(e){return this.publicVapidKeyToUse?[2,this.publicVapidKeyToUse]:[2,ge]}))}))},Ye.prototype.setupSWMessageListener_=function(){var e=this;navigator.serviceWorker.addEventListener("message",(function(t){return i(e,void 0,void 0,(function(){var e,n,r,i,s;return o(this,(function(o){switch(o.label){case 0:return t.data&&t.data.firebaseMessagingType&&t.data.firebaseMessagingData?(e=t.data,n=e.firebaseMessagingType,r=e.firebaseMessagingData,this.messageObserver&&this.messageObserver.next(r),(i=r.data)&&ye in i&&"1"===i["google.c.a.e"]?(s=function(e){switch(e){case de.NOTIFICATION_CLICKED:return"notification_open";case de.PUSH_MSG_RECEIVED:return"notification_foreground";default:throw new Error}}(n),[4,this.services.analyticsProvider.get()]):[3,2]):[2];case 1:o.sent().logEvent(s,{message_name:i["google.c.a.c_l"],message_id:i[ye],message_time:i["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)}),o.label=2;case 2:return[2]}}))}))}),!1)},Ye);function Ye(e){var t=$e.call(this,e)||this;return t.registrationToUse=null,t.publicVapidKeyToUse=null,t.messageObserver=null,t.tokenRefreshObserver=null,t.onMessageInternal=h((function(e){t.messageObserver=e})),t.onTokenRefreshInternal=h((function(e){t.tokenRefreshObserver=e})),t.setupSWMessageListener_(),t}function Ze(){return self&&"ServiceWorkerGlobalScope"in self?"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"):navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}ze={isSupported:Ze},(Ge=e).INTERNAL.registerComponent(new y("messaging",(function(e){var t={app:e.getProvider("app").getImmediate(),installations:e.getProvider("installations").getImmediate(),analyticsProvider:e.getProvider("analytics-internal")};if(!Ze())throw be.create("unsupported-browser");return self&&"ServiceWorkerGlobalScope"in self?new Le(t):new Je(t)}),"PUBLIC").setServiceProps(ze)),Ge.registerVersion("@firebase/messaging","0.6.0")}).apply(this,arguments)}catch(e){throw console.error(e),new Error("Cannot instantiate firebase-messaging - be sure to load firebase-app.js first.")}}));